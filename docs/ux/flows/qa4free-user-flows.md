# QA4Free – User Flows (MVP)

> Бележка (beelms): Тук са описани key user flows за продукта QA4Free като примерна инстанция, изградена върху core рамката **beelms**.

_Роля: UX Designer / Analyst. Фаза: BMAD Phase 2 – Prototypes. Този документ описва ключовите потребителски потоци (user flows) за MVP версията на QA4Free._

## 1. Обхват и цел

Този документ стъпва върху:
- `docs/ux/qa4free-ux-design.md` – текстови wireframes и списък с екрани (SCR-*);
- `docs/product/prd.md` – функционални изисквания (FR-*);
- `docs/architecture/mvp-feature-list.md` – MVP по екрани/модули.

Целта е да дефинира **ключовите сценарии**, които трябва да бъдат покрити от UX, разработката и тестването в MVP.

Нотация:
- Използваме идентификатори `FLOW-*` за потоци.
- В скоби реферираме към екрани (`SCR-*`) от `docs/ux/qa4free-ux-design.md`.

---

## 2. Auth & навигация към основни модули

### FLOW-AUTH-LOGIN-TO-WIKI

**Цел:** Гост потребител да влезе в системата и да стигне до Wiki.

**Стъпки:**
1. Guest отваря начална страница или `/wiki` (SCR-WIKI-LST).
2. В header вижда линк „Login“ → кликва.
3. Системата показва Login екран (SCR-LOGIN).
4. Потребителят въвежда валиден email + password и натиска „Login“.
5. При успех системата:
   - издава JWT/сесия;
   - прави redirect към Wiki List (SCR-WIKI-LST) или към предишно исканата страница.

**Алтернативи / грешки:**
- Невалидни креденшъли → грешка на SCR-LOGIN, без смяна на екрана.

---

### FLOW-AUTH-LOGIN-TO-SANDBOX-UI

**Цел:** Потребител (вкл. гост) да стигне до Sandbox UI за упражнения.

**Стъпки:**
1. Guest вижда header с „Practical UI“ → кликва.
2. Системата зарежда директно `/practice/ui` (SCR-SBX-UI), независимо дали е логнат или не – MVP **не принуждава** потребителя да се вписва за достъп до Sandbox UI.
3. Потребителят взаимодейства със страници/елементи в Sandbox UI (Text Box, Complex Form, Table CRUD и др.).


---

### FLOW-AUTH-FORGOT-RESET

**Цел:** Потребителят да възстанови забравена парола.

**Стъпки:**
1. На Login екрана (SCR-LOGIN) потребителят клика „Forgot password?“.
2. Системата показва Forgot Password (SCR-FORGOT).
3. Потребителят въвежда email и натиска „Send reset link“.
4. Системата показва съобщение, че ако emailът съществува, ще бъде изпратен линк.
5. Потребителят отваря линка от имейла → зарежда се Reset Password (SCR-RESET) с валиден токен.
6. Потребителят въвежда нова парола + потвърждение и натиска „Change password“.
7. При успех – показва се съобщение за успешна смяна и линк към Login (SCR-LOGIN).

**Алтернативи / грешки:**
- Невалиден/изтекъл токен → съобщение за грешка на SCR-RESET с опция да поиска нов линк.

---

### FLOW-AUTH-PROFILE-VIEW-UPDATE

**Цел:** Вписан потребител да разгледа профилната си информация и да актуализира email и/или паролата си през екрана „Моят профил" (`/profile`).

**Стъпки:**
1. Вписан потребител (User/Admin) отваря „Моят профил" от навигацията → зарежда се `/profile` (екран „Моят профил").
2. Системата зарежда и показва основна профилна информация (поне email и дата на регистрация), извлечена през `GET /api/users/me`.
3. За смяна на email:
   - Потребителят натиска „Промяна" до реда с email.
   - Появява се inline форма за нов email с client-side валидация (валиден формат).
   - При потвърждение UI извиква `PATCH /api/users/me`.
   - При успех: UI обновява показания email и показва съобщение за успех.
   - При грешка (невалиден формат/дублиран email/сървърна грешка): UI показва общо съобщение за грешка, без да разкрива дали даден email вече е зает.
4. За смяна на парола:
   - Потребителят натиска „Промяна" до реда за парола.
   - Появява се форма с полета „Текуща парола", „Нова парола" и „Потвърждение".
   - UI прави client-side валидация (поне 8 символа и съвпадение на новата/потвърдена парола).
   - При потвърждение UI извиква `POST /api/users/me/change-password`.
   - При успех: UI показва съобщение за успешна смяна на паролата.
   - При грешка (грешна текуща парола/друга валидационна грешка): UI показва общо съобщение за грешка, без да уточнява кое условие е нарушено.

**Алтернативи / грешки:**
- Неуспешно зареждане на профилните данни → показва се общо съобщение за грешка и опция за опит по-късно.
- Изтичане/невалидност на JWT токена → redirect към `/auth/login`.

---

### FLOW-AUTH-ACCOUNT-EXPORT

**Цел:** Потребителят да заяви експорт на своите лични данни в съответствие с GDPR.

**Стъпки:**
1. Вписан потребител отваря `/profile` и навигира до секция „Експорт на данни (GDPR)".
2. Системата показва текст, който обяснява какви данни влизат в експорта (профилна информация, история на действията и др.).
3. Преди да активира бутона за експорт, потребителят преминава през CAPTCHA / reCAPTCHA компонент.
4. След успешно попълнен CAPTCHA потребителят натиска „Експортирай моите данни".
5. UI извиква `POST /api/users/me/export`.
6. При успех:
   - UI показва потвърждение, че заявката е приета и/или предоставя начин за сваляне на готовия файл (според договореното API поведение).

**Алтернативи / грешки:**
- Непреминат или невалиден CAPTCHA → заявката не се изпраща, показва се подходящо съобщение.
- Сървърна грешка при експорт → показва се общо съобщение за грешка и препоръка за опит по-късно.

---

### FLOW-AUTH-ACCOUNT-DELETE

**Цел:** Потребителят да закрие/изтрие акаунта си чрез единен GDPR-съвместим flow с двустепенно потвърждение.

**Стъпки:**
1. Вписан потребител отваря `/profile` и навигира до секция „Закриване на акаунта (изтриване)".
2. Системата показва ясно предупреждение, че действието е окончателно и личните данни ще бъдат премахнати/анонимизирани според GDPR.
3. Потребителят натиска бутона „Изтрий акаунта завинаги".
4. Появява се първи диалог (Step 1) за потвърждение – потребителят може да:
   - откаже (затваря диалога, нищо не се променя), или
   - потвърди (преминава към втори диалог).
5. Появява се втори диалог (Step 2) „Потвърдете изтриването на акаунта", който изисква финално потвърждение.
6. При финално потвърждение UI извиква `DELETE /api/users/me`.
7. При success:
   - локалните Auth данни се изчистват (JWT/сесия),
   - потребителят се пренасочва към подходящ публичен екран (напр. начална страница/Wiki) със съобщение, че акаунтът е изтрит.

**Алтернативи / грешки:**
- Потребителят отказва на някой от диалозите → flow-ът се прекъсва, няма промяна по акаунта.
- Сървърна грешка при `DELETE /api/users/me` → показва се общо съобщение за грешка; потребителят остава вписан, акаунтът не се счита за изтрит.

---

## 3. Wiki потоци

### FLOW-WIKI-BROWSE

**Цел:** Потребителят да открие статия през Wiki List.

**Стъпки:**
1. Потребител (Guest/User/Admin) отваря `/wiki` (SCR-WIKI-LST) от главното меню.
2. По желание използва Search поле и филтър по език.
3. Вижда списък от статии и избира една по заглавие.
4. Клик върху заглавие → зарежда се Wiki Article (SCR-WIKI-ART).
5. Чете съдържанието.

**Варианти:**
- Смяна на езика през Language switcher в header-а → същият slug, статията се презарежда на новия език.

---

### FLOW-WIKI-NOT-FOUND

**Цел:** Поведение при невалиден slug.

**Стъпки:**
1. Потребителят отваря URL към несъществуваща статия (slug не е валиден).
2. Системата показва 404/Not found състояние на Wiki Article (SCR-WIKI-ART) с ясно съобщение.
3. Линк „Back to Wiki list“ връща към SCR-WIKI-LST.

---

## 4. Sandbox UI & Training API потоци

### FLOW-SBX-UI-BROWSE-CATEGORIES

**Цел:** Потребителят да избере група UI елементи и да упражнява взаимодействия.

**Стъпки:**
1. От header потребителят избира „Practical UI“ → `/practice/ui` (SCR-SBX-UI).
2. Вляво (или като табове) вижда списък с категории (Text Box, Check Box, Buttons и др.).
3. Клик върху категория „Text Box“ → зарежда се страница „Text Box elements“.
4. Потребителят взаимодейства с input-ите (въвежда текст, проверява поведение на disabled/read-only, reset и т.н.).
5. По желание превключва към други категории (Check Box, Radio Button и др.) през вътрешната навигация.

---

### FLOW-SBX-UI-COMPLEX-REGISTRATION

**Цел:** Да се упражнява автоматизация върху комплексната форма за регистрация.

**Стъпки:**
1. От `/practice/ui` потребителят избира категория „Complex Form (Registration)“.
2. Зарежда се страницата с комплексната форма (описана в UX документа, секция 5.4).
3. Попълва полетата First Name, Last Name, Email, Date of Birth (`dd/mm/yyyy`), Country и др.
4. Натиска „Register“.
5. Под формата се показва секция „Registration result“ с форматирани данни (Full Name, дата като „21 June 2020“ и др.).

---

### FLOW-SBX-UI-TABLE-CRUD

**Цел:** Да се упражнява автоматизация върху таблица с добавяне/редакция/изтриване + пагинация.

**Стъпки:**
1. От `/practice/ui` потребителят избира категория „Table CRUD & Pagination“.
2. Зарежда се таблицата с начални (или празни) данни и форма за добавяне на запис.
3. Потребителят попълва формата (Name, Email, Role) и натиска „Add row“ → появява се нов ред.
4. Редактира съществуващ ред чрез „Edit“ → променя стойности → запазва.
5. Изтрива ред чрез „Delete“ → редът изчезва (по възможност с потвърждение).
6. Когато записите станат >10, появява се втора страница → потребителят може да превключва между Page 1 / Page 2.

---

### FLOW-TRAINING-API-SWAGGER

**Цел:** Потребителят да отвори Training API и да изпълни примерни заявки през Swagger UI.

**Стъпки:**
1. От header потребителят избира „Training API“ → `/practice/api` (SCR-SBX-API).
2. Зарежда се страница „Training API“ със вграден Swagger UI.
3. Потребителят избира endpoint `GET /api/training/ping` → въвежда (ако има) параметри → натиска „Execute“ → вижда статус 200 и отговор.
4. Потребителят избира endpoint `POST /api/training/echo` → попълва примерен JSON → „Execute“ → вижда echo отговор.

---

## 5. Admin потоци

### FLOW-ADMIN-LOGIN-TO-DASHBOARD

**Цел:** Администраторът да влезе и да стигне до Admin Dashboard.

**Стъпки:**
1. Админ отваря Login (SCR-LOGIN) и влиза със своите креденшъли.
2. Системата разпознава ролята „Admin“ и след успешен вход показва `SCR-ADMIN-DB` или дава достъп до „Admin“ меню в header-а.
3. Админ избира „Admin“ от менюто (ако не е вече там) → зарежда се Admin Dashboard.

---

### FLOW-ADMIN-MANAGE-WIKI

**Цел:** Админът да управлява Wiki статии и версии.

**Стъпки:**
1. От Admin Dashboard (SCR-ADMIN-DB) или Admin менюто админ избира „Wiki“ → `SCR-ADMIN-WK`.
2. Вижда таблица със статии, може да търси по заглавие/slug, да филтрира по език/статус (Draft / Active / Inactive).
3. От `SCR-ADMIN-WK` може да:
    - натисне „Create new article“ → зарежда се `SCR-ADMIN-WE` в режим **create**;
    - избере статия и натисне „Edit“ → зарежда се `SCR-ADMIN-WE` в режим **edit** за избраната статия;
    - избере статия и натисне „View versions/history“ → `SCR-ADMIN-WV`.
4. В режим create/edit админът избира статус на статията (Draft / Active / Inactive). Типичен сценарий е статията да бъде създадена като Draft, прегледана/редактирана и по-късно маркирана като Active, за да стане видима публично.
5. В същия екран (SCR-ADMIN-WE) админът може да качва и изтрива изображения, свързани със статията (media секция), и да използва върнатите URL-и в markdown съдържанието.
6. На `SCR-ADMIN-WV` избира две версии → вижда Diff → може да натисне „Restore“ за да върне стара версия.

---

### FLOW-ADMIN-MANAGE-USERS

**Цел:** Админът да активира/деактивира потребители.

**Стъпки:**
1. От Admin Dashboard или Admin менюто избира „Users“ → `SCR-ADMIN-US`.
2. Вижда таблица с потребители, може да търси по email и да филтрира по статус.
3. За избран потребител натиска „Deactivate“ → системата пита за потвърждение → след потвърждение статусът става „Deactivated“.
4. Аналогично може да активира отново деактивиран потребител чрез „Activate“.

---

Тези потоци покриват основните сценарии от MVP. Допълнителни детайли (точни съобщения за грешки, micro flows вътре във всеки екран) се описват в `docs/ux/qa4free-ux-design.md` и в бъдещата дизайн система.
