# Епик: Система за управление на учебно съдържание (Course CMS)

## Бизнес цел
Да осигурим лесен за използване и разширяем механизъм за създаване, редактиране, версиониране и визуализация на курсове и глави в LMS. Добре структуриранo съдържание увеличава ангажираността на студентите и улеснява разрастването на каталога от курсове.

## Метрики за успех / KPI
- Време за зареждане на страница със съдържание (p95) ≤ **2 s**
- Точност на progress tracking ≥ **98 %**
- Процент успешно създадени/актуализирани ресурси (CRUD) ≥ **99 %**
- Средно време за публикуване на нова глава ≤ **5 min**
- <2 % от версиите на съдържанието изискват rollback
- Критични WCAG 2.1 AA accessibility issues = **0** ( Lighthouse / axe-core scan )

## Основни изисквания
- **CRUD за курсове и глави**
  - REST/GraphQL endpoints за създаване, четене, актуализиране и изтриване
  - Йерархия: Курс → Глава → Съдържание (markdown, видео, изображение)
- **Поддръжка на форматите**
  - Markdown рендеринг (подсет), вградени изображения, YouTube/Vimeo вграждане
  - Drag-and-drop качване на изображения/видео (локално storage за dev)
- **Версиониране**
  - Запис на всяка промяна с автор, timestamp и diff
  - Възможност за preview и rollback към предишна версия
- **Проследяване на прогреса**
  - Автоматично: достигане 90 % scroll / video ended
  - Ръчно: бутон "Маркирай като прочетено"
  - API за извличане на статистики (завършени глави, време прекарано)
- **Frontend интерфейс** (React)
  - Страница с индекс на курса, навигация през глави
  - Компонент за съдържание с прогрес индикатор
  - Спазване на WCAG 2.1 AA (контраст, alt текст, клавиатурна навигация) проверено чрез автоматични axe-core тестове
- **Ролеви достъп**
  - Засега само администраторът може да редактира съдържанието (MVP). Възможност за по-фини роли може да се разгледа на по-късен етап.
- **Тестове и наблюдаемост**
  - Unit + integration тестове за service & controller слоеве (>90 % покритие)
  - Логове за съдържателни операции (create/update/delete) → console dev

## Извън обхвата
- Live streaming / уебинари
- Мобилно офлайн съдържание
- Автоматичен превод / локализация на съдържание

## Зависимости
- Завършен епик за автентикация (JWT + RBAC)
- Таблици `courses`, `chapters`, `content_versions` в PostgreSQL
- Локално хранилище за медия (Docker volume) – ще се мигрира към S3 при продакшън
- Markdown / медиен рендерер библиотека (Remark / React Markdown)
- CI pipeline за автоматични тестове

## Рискове и смекчаване
| Риск | Въздействие | Вероятност | Митигиране |
|------|-------------|------------|------------|
| Голяма медия забавя зареждането | Средно | Средно | Lazy-load, оптимизация на изображения, лимит на размер |
| Конфликти при успоредна редакция | Средно | Ниско | Locked editing или merge стратегия при бъдещи версии |
| Неправилно отчитане на прогрес | Средно | Средно | Юнит тестове + e2e тестове за tracking логика |
| Обемно бързо растящо съдържание | Високо | Средно | Подготовка за S3 и CDN миграция в продакшън |

## График / Основни етапи
| Етап | Целева дата | Отговорник |
|------|-------------|------------|
| DB модели & миграции (courses/chapters/content) | Седмица 1 | Backend Dev |
| CRUD API за курсове и глави | Седмица 1 | Backend Dev |
| Версиониране на съдържание | Седмица 2 | Backend Dev |
| React UI за преглед на курсове/глави | Седмица 2 | Frontend Dev |
| Прогрес tracking (автоматичен + ръчен) | Седмица 3 | Full-stack Dev |
| Тестове, CI интеграция и документация | Седмица 3 | QA / Dev |

> Оценена продължителност: **3 седмици**, MVP готов за локално демонстрационно съдържание.

## i18n & L10n
- Поддръжка на многоезични курсове (ключове във фронтенда)
- Приемат се `Accept-Language` и `lang` параметри в API за съдържание
- Проверкa за липсващи преводи с `npm run i18n:check` в CI
