# Епик: Система за тестове и оценяване (Assessment Engine)

## Бизнес цел
Да позволим на платформата да измерва знанията и напредъка на студентите чрез интерактивни тестове, автоматично оценяване и богата обратна връзка. Надеждната система за оценяване увеличава мотивацията на обучаващите се и предоставя ценни данни за преподавателите и анализа.

## Метрики за успех / KPI
- 95-ти персентил време за изпращане на тест ≤ **300 ms**
- Точност на автоматичното оценяване (спрямо ръчна проверка) ≥ **95 %**
- Процент успешно завършени тестове ≥ **80 %**
- Средно време за генериране на резултати ≤ **2 s**
- Успешен експорт на данни ≥ **99 %**
- Критични WCAG 2.1 AA accessibility issues = **0** (axe-core scan на assessment UI)

## Основни изисквания
- **Създаване и управление на тестове**
  - CRUD API за тестове и въпроси (single choice, multiple choice, свободен текст)
  - Поддръжка на времеви ограничители (per test или per question)
  - UI компонент за създаване/редактиране на тестове (MVP: JSON seed + admin UI в по-късен етап)
- **Процес на провеждане**
  - Render компонент за въпроси и навигация през секции, съвместим с WCAG 2.1 AA (фокус индикатори, ARIA labels, контраст)
  - Таймер с автоматичен submit при изтичане
  - За свободен текст – запис при blur/enter
- **Оценяване**
  - Автоматично за objective въпроси (single/multiple)
  - Съхранение на отговори за свободен текст (оценка ръчно на по-късен етап)
  - Изчисляване на общ резултат и pass/fail
- **Обратна връзка**
  - Детайлен екран с правилни/грешни отговори и обяснения
  - Email нотификация (dev: console output)
- **Статистика & отчети**
  - Individual results endpoint
  - Aggregated статистики (среден резултат, разпределение) + CSV експорт
- **Сигурност и анти-cheat**
  - Rate-limiting на submit опити
  - Запис на IP, UA и време за всяка сесия
- **Тестове и наблюдаемост**
  - Unit + integration тестове (>90 % покритие)
  - Логиране на опити, резултати и грешки → console dev

## Извън обхвата
- Автоматично оценяване на есета чрез NLP
- Видео/екранно проучване (proctoring)
- AI детекция на измама

## Зависимости
- Завършени епики 1 (автентикация) и 2 (курсове) – за идентифициране на потребител и връзка тест → курс
- Таблици `tests`, `questions`, `choices`, `submissions`, `results` в PostgreSQL
- Redis за временно кеширане на сесии/таймери
- Frontend компоненти (React)
- CI pipeline за тестове

## Рискове и смекчаване
| Риск | Въздействие | Вероятност | Митигиране |
|------|-------------|------------|------------|
| Натоварване при едновременни изпити | Високо | Средно | Pagination на въпросите, ограничаване на concurrency, horizontal scaling |
| Неточност при автоматично оценяване | Средно | Ниско | Unit тестове на scoring logic, sample manual review |
| Опити за измама (multiple attempts, copy answers) | Средно | Средно | Rate-limit, random shuffle на въпроси, уникални токени |
| Загуба на данни при submit | Високо | Ниско | Транзакции + retry механизъм |

## График / Основни етапи
| Етап | Целева дата | Отговорник |
|------|-------------|------------|
| DB схема & миграции (tests/questions/results) | Седмица 1 | Backend Dev |
| CRUD API + автоматично оценяване | Седмица 1 | Backend Dev |
| Frontend render + таймер | Седмица 2 | Frontend Dev |
| Обратна връзка & статистики | Седмица 2 | Full-stack Dev |
| Експорт & агрегирани отчети | Седмица 3 | Backend Dev |
| Тестове, CI и док. | Седмица 3 | QA / Dev |

> Оценена продължителност: **3 седмици**, функционална система за тестове готова за локално използване.

## i18n & L10n
- Въпросите и UI съобщенията поддържат многоезичност
- API приема `Accept-Language` за текстове на въпроси и обяснения
- Report/експорт данните включват locale‐зависими формати
