# QA4Free – Product Requirements Document (PRD)
_Роля: PM (Product Manager). Фаза: BMAD Planning / Solutioning. Описва какви изисквания трябва да покрие продуктът за първата MVP версия._

## 1. Цел и обхват

Този документ описва продуктовите изисквания за **QA4Free** – онлайн платформа „Wikipedia за Quality Assurance + практическа среда за упражнения“.
...
- MVP функционалности по екрани/модули – `docs/architecture/mvp-feature-list.md`
- API спецификация – `docs/architecture/openapi.yaml`

Фокусът е върху **първата платформена версия** (текущото MVP), без да включва бъдещи разширения като exams, курсове и реклами.

## 2. Потребители и таргет аудитория

Обобщение (детайли в Product Brief §2):
- Начинаещи в QA – използват Wiki + практическа среда за обучение.
- По-напреднали / senior QA – използват Wiki като справочник и training API за упражнения.

Роли в системата (детайли в `system-architecture.md` → „Потребителски роли и права“):
- Администратор
- Потребител (регистриран)
- Гост (нерегистриран потребител)

## 3. Бизнес цели (резюме)

Извлечени от Product Brief §1–4:
- Централизирано, фокусирано върху QA **хранилище от знания** (Wiki).
- **Практическа среда** (UI + API), подходяща за manual и automation тестване.
- Платформата да е **безплатна** за крайните потребители.

## 4. Функционални изисквания (FR)

Тук са описани основните функционални области. Детайлизираното поведение по екрани и UX сценарии се държи в `docs/architecture/mvp-feature-list.md`.

### 4.1. Публична Wiki (FR-WIKI)

Обхват (MVP Feature List §1):
- Публичен списък със статии (търсене, филтриране по език).
- Екран „Wiki статия“ с превключване на език.

Ключови изисквания:
- FR-WIKI-1: Гост и регистриран потребител могат да преглеждат списък със статии без регистрация.
- FR-WIKI-2: Потребителят може да филтрира по език (напр. BG/EN) и да търси по заглавие/ключова дума.
- FR-WIKI-3: Екран „Wiki статия“ показва заглавие, съдържание и базова мета информация (последна редакция) и предоставя действия „Сподели“ (споделяне/копиране на линка към статията) и „Принтирай“ (отпечатване на съдържанието през браузъра).
- FR-WIKI-4: При налични езикови версии потребителят може да превключва между тях.
- FR-WIKI-5: Публичните Wiki екрани (списък и статия) показват само статии със статус `Active`. Статии в статус `Draft` или `Inactive` са достъпни и управляеми единствено през Admin панела.

API покритие:
- `GET /api/wiki/articles`
- `GET /api/wiki/articles/{slug}`

### 4.2. Акаунт и профил (FR-AUTH)

Обхват (MVP Feature List §2, Product Brief §5.2):
- Регистрация, вход/изход, забравена парола.
- Профил, закриване/изтриване на акаунта (единен потребителски flow, GDPR – right to be forgotten), експорт на лични данни.

Ключови изисквания:
- FR-AUTH-1: Регистрация с имейл и парола; валидация според минимални правила за сигурност.
- FR-AUTH-2: Вход с имейл и парола; издаване на JWT токен.
- FR-AUTH-3: Забравена парола – заявка и смяна чрез токен, валиден **24 часа**; при изтекъл/невалиден токен системата показва грешка на екрана Reset Password и изисква потребителят да подаде нова заявка през Forgot Password.
- FR-AUTH-4: Потребителят може да прегледа основна профилна информация (имейл, дата на регистрация).
- FR-AUTH-5: Потребителят може да закрие/изтрие акаунта си чрез единен flow (GDPR – right to be forgotten – окончателно изтриване/анонимизиране на личните данни, без възможност за възстановяване), с двустепенно потвърждение от страна на потребителя (два последователни диалога за потвърждение).
- FR-AUTH-6: Потребителят може да заяви експорт на личните си данни.
 - FR-AUTH-7: Anti-bot защита (напр. Google reCAPTCHA) при критични операции: регистрация, заявка за забравена парола, заявки за експорт на лични данни и (по избор) при вход след няколко последователни неуспешни опита.
 - FR-AUTH-8: Системата прилага базов rate limiting за чувствителни email операции – напр. ограничение на броя успешни потвърждения на смяна на email за даден акаунт (примерно 3 потвърждения в рамките на 24 часа), като при достигане на лимита се връща справедливо съобщение за грешка и потребителят вижда кога ще може отново да заяви промяна.

API покритие (детайли в `openapi.yaml`):
- `POST /api/auth/register`
- `POST /api/auth/login`
- `POST /api/auth/forgot-password`
- `POST /api/auth/reset-password`
- `GET /api/users/me`, `DELETE /api/users/me`, `POST /api/users/me/export`

### 4.3. Практическа среда – UI демо (FR-UI-DEMO)

Обхват (MVP Feature List §3):
- Страница с различни UI елементи (бутони, dropdown, полета и др.).
- Примерни задачи и възможност за reset на състоянието.

Ключови изисквания:
- FR-UI-DEMO-1: Един или повече екрани с богата комбинация от HTML елементи за упражнения.
- FR-UI-DEMO-2: Описание на целта на екрана и примерни упражнения за manual/UI automation тестване.
- FR-UI-DEMO-3: Възможност за връщане екрана в начално състояние (reset).

Тези изисквания са изцяло във frontend слоя и не изискват специфични API ендпойнти освен стандартните за зареждане на страниците.

### 4.4. Практическа среда – API демо / Training API (FR-API-DEMO)

Обхват (MVP Feature List §4, System Architecture §„Демо среда…“):
- Swagger/OpenAPI интерфейс към **Training API** за упражнения по API/integration тестване.

MVP версията на Training API е **минимална** – фокусира се върху няколко прости ендпойнта за упражнения (ping/echo). Пълният CRUD демо ресурс, описан концептуално в MVP Feature List §4, е планиран за следваща версия (post-MVP).

Ключови изисквания:
- FR-API-DEMO-1: Публично достъпен Swagger UI за Training API.
- FR-API-DEMO-2: Поне два ендпойнта за упражнения (hello world, echo), позволяващи позитивни и негативни тестове.
- FR-API-DEMO-3: Training API да бъде отделен бекенд сервиз в отделен Docker контейнер, зад API Gateway.

API покритие:
- `GET /api/training/ping`
- `POST /api/training/echo`

### 4.5. Практическа среда – задачи и оценяване (FR-TASKS)

Обхват (System Architecture §Практическа среда, „Диаграма на последователност…“):
- Зареждане на дефинирана задача.
- Изпращане на решение и автоматично оценяване.

Ключови изисквания:
- FR-TASKS-1: Публичен endpoint за зареждане на задача по идентификатор.
- FR-TASKS-2: Публичен endpoint за изпращане на решение за задача.
- FR-TASKS-3: Системата връща резултат (успех/неуспех, score, feedback).

API покритие:
- `GET /api/tasks/{id}`
- `POST /api/tasks/{id}/submit`

### 4.6. Администраторски панел (FR-ADMIN)

Обхват (MVP Feature List §5):
- Управление на Wiki съдържание и версии.
- Управление на потребители (активиране/деактивиране).
- Базово табло с метрики.

Ключови изисквания:
- FR-ADMIN-1: Админ може да създава, редактира и управлява статусите на Wiki статиите (Draft / Active / Inactive), включително деактивиране/скриване без окончателно изтриване, както и да качва и изтрива изображения, свързани с дадена статия, които се използват в markdown съдържанието.
- FR-ADMIN-2: Админ може да преглежда история на версиите на статия, да връща към предишна версия и да трие избрани стари версии.
- FR-ADMIN-3: Админ може да преглежда списък с потребители и да активира/деактивира акаунти.
 - FR-ADMIN-4: Админ табло показва базови метрики (поне брой регистрирани потребители). В текущото MVP не се показват и не се събират метрики за брой изпълнени практичeски задачи – те се отлагат за бъдещия „exams“ модул.

API покритие (частично):
- `/api/admin/wiki/articles...`
- `/api/admin/wiki/articles/{id}/versions...`
- `/api/admin/users`, `/api/admin/users/{id}`
- `GET /api/admin/metrics/overview`

### 4.7. Cross-cutting функционалности (FR-CROSS)

Обхват (MVP Feature List §6, System Architecture – GDPR, Метрики, Безопасност):
- Мултиезичност в интерфейса и съдържанието.
- GDPR и управление на данни.
- Метрики и анализи.
- Безопасност.

Ключови изисквания (обобщени):
- FR-CROSS-1: Поддръжка на поне два езика в интерфейса (напр. BG и EN).
- FR-CROSS-2: Права по GDPR – достъп, изтриване, преносимост, корекция, плюс публична страница „Privacy/GDPR“ с обобщена информация за обработката на данни.
- FR-CROSS-3: Събиране на базови метрики за потребителско поведение и производителност на системата. Метрики за индивидуален учебен напредък (завършени задачи/exams) не са част от текущото MVP и ще се добавят в бъдещия „exams“ модул.
  - За текущото MVP минималното изискване за метрики е наличието на агрегирана стойност "брой регистрирани потребители", показвана в Admin Dashboard / Admin Metrics (виж FR-ADMIN-4 и mvp-feature-list §5.4). По-сложните агрегирани метрики (брой сесии, средна продължителност, разпределение по източник на трафик, периоди, export на данни и др.) са планирани като **post-MVP** функционалност и са описани в `docs/product/post-mvp-backlog.md` (MTX-POST-1).
- FR-CROSS-4: Основни защити – CSRF, XSS, SQL injection, защита срещу brute force атаки.
- FR-CROSS-5: Публични статични страници „About“ и „Contact“, достъпни от footer-а на основните екрани.
- FR-LEGAL-1: Публична статична страница „Условия за ползване (Terms of Use)“, достъпна от footer-а на основните екрани и от регистрационната форма (checkbox „Съгласен съм с условията за ползване и политиката за поверителност“).

## 5. Нефункционални изисквания (NFR)

Подробностите са описани основно в `docs/architecture/system-architecture.md`. Тук са събрани ключовите теми:

### 5.1. Производителност и мащабируемост

- NFR-1: Системата трябва да поддържа начално ниско натоварване на една VPS машина (описана в Product Brief §6.2 и System Architecture §Инфраструктура).
- NFR-2: Архитектурата трябва да позволява хоризонтално мащабиране на бекенд услугите при нужда.

### 5.2. Сигурност и GDPR

- NFR-3: Всички връзки са криптирани (HTTPS, TLS сертификати чрез Let's Encrypt).
- NFR-4: Личните данни се съхраняват и обработват съгласно GDPR (GDPR секция в System Architecture).
- NFR-5: JWT токени с разумен срок и механизъм за отнемане.

### 5.3. Наличност и надеждност

- NFR-6: Основните услуги (Wiki, Auth, Practical Env) трябва да бъдат проектирани така, че да се възстановяват бързо при рестарт на контейнерите.

### 5.4. UX и дизайн ограничения

- NFR-7: Цветова схема и стилистика, описани в Product Brief (зелено/червено като основни акценти).

## 6. Зависимости и интеграции

 Основни зависимости:
 - Next.js frontend приложение.
 - NestJS backend услуги (auth, wiki, practical_env, training-api, metrics).
 - PostgreSQL и Redis.
 - RabbitMQ като message broker за асинхронни задачи и опашки.
 - Външна имейл услуга (за забравена парола и нотификации).

Интеграции (обобщени):
- Frontend ↔ API Gateway (REST/HTTPS).
- Практическа среда ↔ Sandbox/Docker за изпълнение на задачи.
- Метрики ↔ Prometheus/Grafana (в по-късна фаза от инфраструктурата).

## 7. Трейсабилност към други документи

- Product Brief – бизнес контекст и високониво функционален обхват.
- MVP Feature List – детайлно поведение по екрани/модули, което този PRD обобщава на ниво изисквания.
- System Architecture – технически решения, компоненти, NFR, сигурност, инфраструктура.
- OpenAPI спецификация – конкретни REST ендпойнти, които реализират описаните тук функционални изисквания.

Този PRD не дублира пълното съдържание на горните документи, а ги свързва и предоставя **единно място**, откъдето да се вижда какво трябва да прави продуктът, преди да се премине към епики, user stories и реална имплементация.
