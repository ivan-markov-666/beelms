# STORY-WS2-FE-AUTH-REGISTER-LOGIN – UI за регистрация и вход

Status: Done

## Summary
Като **нов или връщащ се потребител** искам да имам **ясни и лесни за ползване екрани за регистрация и вход**, за да мога бързо да създам акаунт или да вляза в съществуващ такъв.

## Links to BMAD artifacts
- PRD – `docs/product/prd.md` (§4.2 FR-AUTH-1, FR-AUTH-2, FR-AUTH-7).
- MVP Feature List – `docs/architecture/mvp-feature-list.md` (§2.1 Регистрация, §2.2 Вход/Изход).
- UX Design – `docs/ux/qa4free-ux-design.md` (Auth екрани за register/login).
- User Flows – `docs/ux/flows/qa4free-user-flows.md` (flows за регистрация и вход).
- System Architecture – `docs/architecture/system-architecture.md` (frontend приложение, навигация, сигурност).
- MCP EPIC Map – `docs/backlog/MCP-EPIC-map.md` (EPIC-AUTH-ACCOUNTS, EPIC-CROSS-I18N, EPIC-CROSS-SECURITY).

## Acceptance Criteria
- Страница `/auth/register`:
  - Показва форма с полета за имейл и парола (и други полета според PRD/UX, ако има такива).
  - Има линк/чекбокс за съгласие с Terms of Use / Privacy (ако UX го изисква още на този екран).
  - Включва anti-bot елемент (напр. reCAPTCHA), в синхрон с PRD/MVP и `EPIC-WS2-AUTH-BE`.
  - Има client-side валидация (формат на имейл, минимална дължина на парола и др.).
  - При успешно изпращане:
    - се извиква `POST /api/auth/register` и при success потребителят получава ясно съобщение (и евентуално се пренасочва към login или директно влиза, според UX).
  - При грешка (валидация/duplicate email/server error) се показват ясни, но неразкриващи чувствителна информация съобщения.
- Страница `/auth/login`:
  - Показва форма за имейл и парола.
  - Има link към „Забравена парола“ (`/auth/forgot-password`).
  - При успешно логване през `POST /api/auth/login` потребителят се счита за вписан (JWT/сесия) и се пренасочва към подходяща landing страница (напр. Wiki списък или dashboard).
  - При неуспешен вход се показва общо съобщение („Невалидни данни за вход“), без да се уточнява кое поле е грешно.
- Общи UX изисквания:
  - И двата екрана използват общ layout и базови UI компоненти от design system-а.
  - Съобщенията за грешка и успех са на правилния език и отговарят на tone-of-voice на продукта.

## Dev Tasks
- [x] Имплементиране на страница `/auth/register` с форма, client-side валидация и интеграция с `POST /api/auth/register`.
- [x] Имплементиране на страница `/auth/login` с форма, client-side валидация и интеграция с `POST /api/auth/login`.
- [x] Управление на Auth състояние на клиента (запазване/изтриване на токени, basic guard за защитени страници, ако е в обхвата на WS-2).
- [x] Интеграция на anti-bot механизъм (напр. reCAPTCHA) в регистрационната форма, в синхрон с BE и security изискванията.
- [x] Използване на базови UI компоненти (inputs, buttons, error messages) от design system-а.
- [x] Ръчно тестване на основните сценарии (успешна регистрация, неуспешна регистрация, успешен/неуспешен login).
- [x] FE тестове за рендване и поведение на формите.

## Test Scenarios

- **[FE-REG-1] Успешна регистрация**
  - Потребителят попълва валиден email и парола (покриващи client-side правилата), потвърждава паролата, маркира Terms checkbox, преминава CAPTCHA и натиска „Register".
  - Очакване: изпраща се заявка към `POST /api/auth/register`; при success UI показва ясно съобщение и/или redirect към Login/автоматичен вход според UX.

- **[FE-REG-2] Невалидни данни при регистрация**
  - Email с невалиден формат, твърде къса парола, непотвърдена парола или немаркиран Terms checkbox.
  - Очакване: формата не изпраща заявка към backend; показват се подходящи validation съобщения под съответните полета.

- **[FE-REG-3] Дублиран email / server-side грешка**
  - BE връща грешка (напр. 400/409 за вече зает email или 5xx за обща грешка).
  - Очакване: UI показва ясно съобщение за грешка (user-friendly, без технически детайли), без да изтърва backend stack traces към потребителя.

- **[FE-LOGIN-1] Успешен вход**
  - Валиден email и парола → `POST /api/auth/login` връща 200 + JWT.
  - Очакване: токенът се запазва според избрания механизъм (cookie/local storage и др.); потребителят се пренасочва към подходяща landing страница (напр. Wiki List); header-ът се обновява към Auth навигация.

- **[FE-LOGIN-2] Невалидни креденшъли**
  - BE връща 401 при грешен email/парола.
  - Очакване: показва се общо съобщение за грешка (напр. „Невалидни данни за вход"), без да се уточнява кое поле е грешно; няма redirect, формата остава на `/auth/login`.

## Notes
- Тази story е тясно свързана със `STORY-WS2-BE-AUTH-REGISTER-LOGIN` и трябва да следи нейния API contract (body, отговори, кодове).
- Добре е да се планира как ще се държи UI-то при забавен отговор на сървъра (loading state), макар детайлните състояния да могат да бъдат изнесени в отделно story при нужда.
- В бъдещи WS може да се добавят допълнителни удобства (запазване на имейл, „remember me“, визуални индикатори за сила на паролата и др.), но за WS-2 целта е минимален, но използваем флоу.
