# 1.8: Тестване на регистрацията

## Описание
Изчерпателно тестване на функционалността за регистрация, включително unit, интеграционни и натоварващи тестове.

## Видове тестове

### 1. Unit тестове
**Обхват:**
- Валидация на входни данни
- Работа с пароли
- Генериране и валидиране на токени
- Изпращане на имейли

**Покритие:**
- Минимум 90% код покритие
- Всички гранични случаи
- Грешки и изключения

### 2. Интеграционни тестове
**Сценарии:**
1. Успешна регистрация
   - Валидиране на изходните данни
   - Проверка на изпратения имейл
   - Проверка на състоянието на базата данни

2. Неуспешна регистрация
   - Липсващи полета
   - Невалиден имейл
   - Слаба парола
   - Вече съществуващ потребител

3. Потвърждение на имейл
   - Валиден токен
   - Изтекъл токен
   - Невалиден токен
   - Вече използван токен

### 3. Натоварващи тестове
**Сценарии:**
- 1000 едновременни регистрации
- 100 заявки/секунда за 5 минути
- Дълготрайно тестване (24 часа)

**Метрики:**
- Време за отговор (p95 < 500ms)
- Грешки (< 0.1%)
- Използване на ресурси (CPU, памет)

## Тестова среда

### Конфигурация
```env
NODE_ENV=test
DATABASE_URL=postgresql://test:test@localhost:5432/lms_test
REDIS_URL=redis://localhost:6379/1
JWT_SECRET=test-secret
```

### Инструменти
- **Jest** - изпълнение на тестове
- **Supertest** - HTTP заявки
- **TestContainers** - Docker контейнери за тестване
- **Faker.js** - Генериране на тестови данни
- **k6** - Натоварващи тестове

## Критерии за приемане
- [ ] Всички тестове минават успешно
- [ ] Достигнато е 90%+ покритие на кода
- [ ] Натоварващите тестове показват стабилност
- [ ] Няма регресии в съществуващата функционалност
- [ ] Всички edge cases са покрити

## Автоматизация
- Изпълняват се при всеки PR
- Изпълняват се при merge в main
- Резултатите се публикуват в CI системата

## Зависимости
- [AUTH-1-T3](AUTH-1-T3.md)
- [AUTH-1-T4](AUTH-1-T4.md)
- [AUTH-1-T5](AUTH-1-T5.md)
- [AUTH-1-T6](AUTH-1-T6.md)

## Свързани файлове
- `test/auth/registration.e2e-spec.ts`
- `test/auth/services/registration.service.spec.ts`
- `test/load/registration.test.js`
- `jest.config.js`
- `.github/workflows/tests.yml`
