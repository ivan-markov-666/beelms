# Auth Service

<p align="center">
  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
</p>

<p align="center">
  <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
  <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
  <a href="https://www.npmjs.com/package/@nestjs/common" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
</p>

## Описание

Auth Service е част от microservices архитектурата на QA-4-Free платформата. Той отговаря за:
- Потребителска автентикация и оторизация
- Управление на потребителски сесии
- Забравени пароли и възстановяване на акаунти
- Генериране и валидиране на JWT токени

## Съдържание

- [Изисквания](#изисквания)
- [Настройка на средата](#настройка-на-средата)
- [Стартиране на приложението](#стартиране-на-приложението)
- [API Документация](#api-документация)
- [Тестване](#тестване)
- [Конфигурация](#конфигурация)
- [Логване](#логване)
- [Поддръжка и контакти](#поддръжка-и-контакти)
- [Лиценз](#лиценз)

## Изисквания

- Node.js (версия 16 или по-нова)
- npm (версия 7 или по-нова)
- PostgreSQL (версия 13 или по-нова)
- Redis (опционално, за кеширане на сесии)

## Настройка на средата

1. Клониране на хранилището
2. Инсталиране на зависимостите:

```bash
npm install
```

3. Копирайте `.env.example` във файл `.env` и попълнете необходимите променливи за средата.

## Стартиране на приложението

### Локално стартиране (за разработка)

```bash
# Стартиране в режим на разработка с автоматично презареждане
npm run start:dev
```

Приложението ще се стартира на порт 4000 по подразбиране (конфигурируемо чрез променливата `PORT` в `.env` файла).

### Стартиране с Docker

```bash
# От корен директорията на проекта
docker-compose up auth-service
```

## API Документация

След като приложението е стартирано, достъпна е интерактивна Swagger документация на:

```
http://localhost:4000/api
```

Документацията включва:
- Всички налични ендпойнти
- Детайлно описание на заявките и отговорите
- Възможност за изпращане на тестови заявки

### Достъп до защитени ендпойнти

1. Влезте в системата чрез `/auth/login` ендпойнта
2. Копирайте получения JWT токен
3. Кликнете върху бутона "Authorize" (с ключалка) в горния десен ъгъл
4. Въведете токена във формат: `Bearer <вашият_токен>`
5. Вече имате достъп до защитените ендпойнти

## Тестване

### Единични тестове

```bash
# Стартиране на всички тестове
npm run test

# Стартиране на тестове в режим на наблюдение
npm run test:watch

# Генериране на покритие на кода
npm run test:cov
```

### Интеграционни тестове

```bash
# Стартиране на интеграционни тестове
npm run test:e2e
```

## Конфигурация

Конфигурационните настройки се управляват чрез `.env` файл. Ето основните настройки:

```env
# База данни
DATABASE_HOST=localhost
DATABASE_PORT=5433
DATABASE_USERNAME=postgres
DATABASE_PASSWORD=your_password
DATABASE_NAME=learning_platform

# JWT
JWT_SECRET=your_jwt_secret
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d

# Redis (опционално)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password

# Приложение
PORT=4000
NODE_ENV=development
```

## Логване

Приложението използва вграденото логване на NestJS. Логовете се извеждат в конзолата и могат да бъдат насочени към файл чрез външен логер.

## Поддръжка и контакти

Ако имате въпроси или срещнете проблеми, моля, отворете тикет в хранилището на проекта.

## Лиценз

Този проект е лицензиран под [MIT лиценз](LICENSE).
